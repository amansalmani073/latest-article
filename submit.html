<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Create Post | Global Travel Guide</title>
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">

<style>
:root { --primary-color:#ff5722; }
body { font-family:'Poppins',sans-serif;background:#f4f7f6;margin:0;padding:20px; }
.container { max-width:900px;margin:0 auto;background:white;padding:30px;border-radius:12px; }
input,select { width:100%;padding:12px;margin:10px 0;border:1px solid #ddd;border-radius:8px; }
#editor { height:350px;margin-bottom:20px; }
.submit-btn { background:var(--primary-color);color:white;border:none;padding:15px;width:100%;border-radius:8px;cursor:pointer;font-weight:bold; }
</style>
</head>

<body>

<div class="container">
<h2>Create New Post</h2>

<input type="text" id="blogTitle" placeholder="Blog Title" required>
<input type="text" id="blogImage" placeholder="Feature Image URL">

<label>Select Category:</label>
<select id="category">
<option value="visa-guides">Visa Guide</option>
<option value="travel-tips">Travel Tips</option>
<option value="destination-guides">Destination Guides</option>
</select>

<div id="editor"></div>

<button id="submitBtn" class="submit-btn" onclick="publishPost()">Publish Blog Post</button>
</div>

<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js";

const firebaseConfig = {
apiKey:"AIzaSyCBSTMljE8h9sa1IldRcuKbaKp84t5hx9s",
authDomain:"latest-article.firebaseapp.com",
projectId:"latest-article",
appId:"1:222132959003:web:a329d719efb6cf7c105be"
};

const app=initializeApp(firebaseConfig);
const db=getFirestore(app);

const quill=new Quill('#editor',{theme:'snow'});

window.publishPost=async()=>{
const title=document.getElementById('blogTitle').value;
const image=document.getElementById('blogImage').value;
const category=document.getElementById('category').value;
const content=quill.root.innerHTML;
const btn=document.getElementById('submitBtn');

if(!title||quill.getText().trim().length===0){
alert("Title & Content Required");
return;
}

btn.disabled=true;
btn.innerText="Publishing...";


// ðŸ”¥ SEO SLUG GENERATOR (STOP WORD REMOVE)
let slug = title
.toLowerCase()
.replace(/should|while|for|the|and|of|to|is|are|applying/g,"")
.replace(/[^a-z0-9\s]/g,'')
.split(" ")
.filter(word => word.length > 2)
.join("-");

try{
await addDoc(collection(db,"user_blogs"),{
title:title,
slug:slug,
image:image,
category:category,
content:content,
author:"Admin",
createdAt:serverTimestamp()
});

alert("Post added with slug: "+slug);

document.getElementById('blogTitle').value="";
document.getElementById('blogImage').value="";
quill.setContents([]);

}
catch(e){alert(e.message);}
finally{
btn.disabled=false;
btn.innerText="Publish Blog Post";
}
};
</script>

</body>
</html>
